# NBD
 Little task for Acronis - write simple NBD server
 Task description on Russian:

Протокол: NBD Network Block Device - github - description: https://github.com/NetworkBlockDevice/nbd/blob/master/doc/proto.md

Написать реализацию сервера, отдает одно блочное устройство по нему - readonly export блочного устройства

loopback, file system

На Golang

Реализуйте NBD-сервер, раздающий одно блочное устройство. Содержимое блочного устройства должно храниться в файле, который передаётся как аргумент командной строки. Достаточно реализовать следующие части протокола:

- handshake с поддержкой опций NBD_OPT_STRUCTURED_REPLY и NBD_OPT_GO,
- запросы NBD_CMD_READ и NBD_CMD_DISC.

Для проверки программы создайте файл с образом какой-либо ФС, подключите его с помощью nbdclient в другой Linux-машине и смонтируйте там этот образ. Улучшения (пока что хватит ограничиться первым):

- Протокол NBD поддерживает отправку ответов вне очереди. Реализуйте исполнение IO в пуле потоков. Как проверить, что мы действительно получаем ускорение от переупорядочивания ответов? Объясните механизм увеличения производительности.
- Замените пул потоков на асинхронный ввод-вывод с помощью io_uring.
- Поддержите structured replies. NBD-клиент в Linux не поддерживает это расширение, им пользуется qemu.
